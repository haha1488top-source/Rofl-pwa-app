<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0000ff">
    <title>–ö–ª—ñ–∫–µ—Ä –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="Img/pin_dead_box.png">
    <link rel="apple-touch-icon" href="Img/pin_dead_box.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="–ö–ª—ñ–∫–µ—Ä">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: Arial, sans-serif;
            padding: 20px;
            touch-action: manipulation;
            transition: background 0.5s ease;
        }

        body.shop-open {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa726 100%);
        }

        /* –ù–û–í–ê –ü–ê–ù–ï–õ–¨ –ú–û–ù–ï–¢ */
        .coin-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(255,255,255,0.9);
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 20px;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .coin-icon {
            font-size: 24px;
        }

        .scene {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
        }

        .counter {
            font-size: 42px;
            color: white;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            text-align: center;
        }

        .clicker-img {
            width: 250px;
            height: 250px;
            cursor: pointer;
            transition: transform 0.1s;
            user-select: none;
            border-radius: 20px;
            margin-bottom: 15px;
        }

        .clicker-img:active {
            transform: scale(0.9);
        }

        .shop-btn {
            margin: 10px 0;
            padding: 15px 30px;
            font-size: 18px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            width: 80%;
            max-width: 280px;
        }

        .reset-btn {
            margin-top: 10px;
            padding: 12px 25px;
            font-size: 18px;
            background: #ff5722;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            width: 80%;
            max-width: 280px;
        }

        .status {
            margin-top: 15px;
            color: white;
            font-size: 16px;
            text-align: center;
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω—É */
        .shop-scene {
            display: none;
        }

        .back-btn {
            margin: 20px 0;
            padding: 12px 25px;
            font-size: 18px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            width: 80%;
            max-width: 280px;
        }

        .shop-items {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
            width: 100%;
            max-width: 300px;
        }

        .shop-item {
            padding: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            color: white;
            text-align: center;
            cursor: pointer;
            border: 2px solid rgba(255,255,255,0.3);
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .shop-item:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        /* –ù–û–í–ï –°–ü–õ–ò–í–ê–Æ–ß–ï –í–Ü–ö–ù–û –î–õ–Ø PWA */
        .pwa-toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            z-index: 10000;
            display: none;
            flex-direction: column;
            gap: 15px;
            max-width: 300px;
            width: 90%;
            text-align: center;
        }

        .pwa-toast.show {
            display: flex;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateX(-50%) translateY(100px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        .pwa-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .pwa-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .pwa-install-btn {
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }

        .pwa-cancel-btn {
            padding: 10px 20px;
            background: #ff5722;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <!-- –ù–û–í–ê –ü–ê–ù–ï–õ–¨ –ú–û–ù–ï–¢ -->
    <div class="coin-panel">
        <span class="coin-icon">ü™ô</span>
        <span id="coinCount">0</span>
    </div>

    <!-- –ù–û–í–ï –°–ü–õ–ò–í–ê–Æ–ß–ï –í–Ü–ö–ù–û PWA -->
    <div class="pwa-toast" id="pwaToast">
        <div class="pwa-title">üì± –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫?</div>
        <div class="pwa-buttons">
            <button class="pwa-install-btn" onclick="installPWA()">–¢–∞–∫</button>
            <button class="pwa-cancel-btn" onclick="hidePWAToast()">–ù—ñ</button>
        </div>
    </div>

    <!-- –ì–æ–ª–æ–≤–Ω–∞ —Å—Ü–µ–Ω–∞ -->
    <div class="scene main-scene" id="mainScene">
        <div class="counter">–ö–ª—ñ–∫—ñ–≤: <span id="count">0</span></div>
        <img src="Img/pin_dead_box.png" class="clicker-img" id="clicker" alt="–ö–ª—ñ–∫–µ—Ä">
        <button class="shop-btn" onclick="openShop()">–ú–∞–≥–∞–∑–∏–Ω</button>
        <button class="reset-btn" onclick="resetCounter()">–°–∫–∏–Ω—É—Ç–∏</button>
        <div class="status" id="status">–ì—Ä–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞! –¢–∏—Å–Ω–∏ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É üëÜ</div>
    </div>

    <!-- –°—Ü–µ–Ω–∞ –º–∞–≥–∞–∑–∏–Ω—É -->
    <div class="scene shop-scene" id="shopScene">
        <div class="counter">üè™ –ú–∞–≥–∞–∑–∏–Ω</div>
        <div class="shop-items">
            <div class="shop-item" onclick="buyUpgrade('autoClick')">ü§ñ –ê–≤—Ç–æ–∫–ª—ñ–∫–µ—Ä<br><small>100 –∫–ª—ñ–∫—ñ–≤</small></div>
            <div class="shop-item" onclick="buyUpgrade('doubleClick')">‚ö° –ü–æ–¥–≤—ñ–π–Ω–∏–π –∫–ª—ñ–∫<br><small>200 –∫–ª—ñ–∫—ñ–≤</small></div>
            <div class="shop-item" onclick="buyUpgrade('megaClick')">üí• –ú–µ–≥–∞ –∫–ª—ñ–∫<br><small>500 –∫–ª—ñ–∫—ñ–≤</small></div>
        </div>
        <button class="back-btn" onclick="closeShop()">‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –¥–æ –≥—Ä–∏</button>
        <div class="status">–¢–≤–æ—ó –∫–ª—ñ–∫—ñ–≤: <span id="shopCount">0</span></div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
        let count = parseInt(localStorage.getItem('clickCount')) || 0;
        let coins = parseInt(localStorage.getItem('gameCoins')) || 0; // –ù–û–í–ê –ó–ú–Ü–ù–ù–ê –ú–û–ù–ï–¢
        let upgrades = JSON.parse(localStorage.getItem('gameUpgrades')) || {
            autoClick: false,
            doubleClick: false,
            megaClick: false
        };
        let deferredPrompt;

        const counterElement = document.getElementById('count');
        const coinCountElement = document.getElementById('coinCount'); // –ù–û–í–ò–ô –ï–õ–ï–ú–ï–ù–¢
        const clickerImg = document.getElementById('clicker');
        const statusElement = document.getElementById('status');
        const shopScene = document.getElementById('shopScene');
        const mainScene = document.getElementById('mainScene');
        const shopCountElement = document.getElementById('shopCount');
        const pwaToast = document.getElementById('pwaToast');

        function updateCounter() {
            counterElement.textContent = count;
            shopCountElement.textContent = count;
            coinCountElement.textContent = coins; // –û–ù–û–í–õ–Æ–Ñ–ú–û –ú–û–ù–ï–¢–ò
            localStorage.setItem('clickCount', count);
            localStorage.setItem('gameCoins', coins); // –ó–ë–ï–†–Ü–ì–ê–Ñ–ú–û –ú–û–ù–ï–¢–ò
        }

        function resetCounter() {
            if(confirm('–°–∫–∏–Ω—É—Ç–∏ —Ä–∞—Ö—É–Ω–æ–∫?')) {
                count = 0;
                coins = 0; // –°–ö–ò–î–ê–Ñ–ú–û –ú–û–ù–ï–¢–ò
                upgrades = { autoClick: false, doubleClick: false, megaClick: false };
                updateCounter();
                localStorage.setItem('gameUpgrades', JSON.stringify(upgrades));
            }
        }

        function openShop() {
            mainScene.style.display = 'none';
            shopScene.style.display = 'flex';
            document.body.classList.add('shop-open');
        }

        function closeShop() {
            shopScene.style.display = 'none';
            mainScene.style.display = 'flex';
            document.body.classList.remove('shop-open');
        }

        function buyUpgrade(type) {
            const costs = { autoClick: 100, doubleClick: 200, megaClick: 500 };
            if (count >= costs[type] && !upgrades[type]) {
                count -= costs[type];
                coins += 10; // –î–û–î–ê–Ñ–ú–û –ú–û–ù–ï–¢–ò –ó–ê –ü–û–ö–£–ü–ö–£
                upgrades[type] = true;
                updateCounter();
                localStorage.setItem('gameUpgrades', JSON.stringify(upgrades));
                alert('üéâ –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∫—É–ø–ª–µ–Ω–æ! +10 –º–æ–Ω–µ—Ç!');
                if (type === 'autoClick') {
                    startAutoClicker();
                }
            } else if (upgrades[type]) {
                alert('‚ÑπÔ∏è –í–∂–µ –∫—É–ø–ª–µ–Ω–æ!');
            } else {
                alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–ª—ñ–∫—ñ–≤!');
            }
        }

        function handleClick() {
            let clickValue = 1;
            if (upgrades.doubleClick) clickValue *= 2;
            if (upgrades.megaClick) clickValue *= 5;
            
            count += clickValue;
            // –ö–û–ñ–ï–ù –ö–õ–Ü–ö –î–û–î–ê–Ñ –ú–û–ù–ï–¢–ò
            coins += Math.floor(clickValue * 0.1); // 10% –≤—ñ–¥ –∫–ª—ñ–∫—ñ–≤ —É –º–æ–Ω–µ—Ç–∏
            updateCounter();
        }

        function startAutoClicker() {
            if (upgrades.autoClick) {
                setInterval(() => {
                    count += 1;
                    coins += 0.1; // –ê–í–¢–û–ö–õ–Ü–ö–ï–† –¢–ï–ñ –î–û–î–ê–Ñ –ú–û–ù–ï–¢–ò
                    updateCounter();
                }, 1000);
            }
        }

        // –ù–û–í–ò–ô –ö–û–î –î–õ–Ø –°–ü–õ–ò–í–ê–Æ–ß–û–ì–û –í–Ü–ö–ù–ê PWA
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // –ü–æ–∫–∞–∑—É—î–º–æ —Å–ø–ª–∏–≤–∞—é—á–µ –≤—ñ–∫–Ω–æ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥–∏
            setTimeout(() => {
                showPWAToast();
            }, 3000);
        });

        function showPWAToast() {
            if (deferredPrompt) {
                pwaToast.classList.add('show');
            }
        }

        function hidePWAToast() {
            pwaToast.classList.remove('show');
        }

        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        hidePWAToast();
                    }
                    deferredPrompt = null;
                });
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ö–æ–≤–∞—î–º–æ —Å–ø–ª–∏–≤–∞—é—á–µ –≤—ñ–∫–Ω–æ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
        setTimeout(hidePWAToast, 10000);

        // –û–±—Ä–æ–±–∫–∞ –∫–ª—ñ–∫—ñ–≤
        clickerImg.addEventListener('touchstart', (e) => {
            e.preventDefault();
            handleClick();
            clickerImg.style.transform = 'scale(0.9)';
        });

        clickerImg.addEventListener('touchend', (e) => {
            e.preventDefault();
            clickerImg.style.transform = 'scale(1)';
        });

        clickerImg.addEventListener('click', () => {
            handleClick();
            clickerImg.style.transform = 'scale(0.9)';
            setTimeout(() => {
                clickerImg.style.transform = 'scale(1)';
            }, 100);
        });

        // –ê–≤—Ç–æ–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
        setInterval(() => {
            localStorage.setItem('clickCount', count);
            localStorage.setItem('gameCoins', coins);
            localStorage.setItem('gameUpgrades', JSON.stringify(upgrades));
        }, 1000);

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        updateCounter();
        startAutoClicker();
        statusElement.textContent = '–ì—Ä–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞! –¢–∏—Å–Ω–∏ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É üëÜ';

        // Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./service-worker.js');
            });
        }
    </script>
</body>
</html>
